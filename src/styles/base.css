html,
body,
#root {
  width: 100%;
  max-width: 100%;
}

/* ── PWA native-app feel ── */
html {
  /* Prevent pull-to-refresh in standalone PWA */
  overscroll-behavior-y: contain;
  /*
   * Do NOT set overflow-x on <html>.
   *
   * - overflow-x:hidden on <html> turns it into a scroll container on iOS
   *   Safari → position:fixed children anchor to the scrolled element
   *   instead of the viewport (bottom-nav drift bug).
   * - overflow-x:clip on <html> opts Android Chrome out of the native
   *   root-scroller layer → touch-based vertical scroll stops working on
   *   Android entirely.
   *
   * Horizontal overflow clipping is already provided by:
   *   .app-shell { overflow-x: clip }  (see below)
   * which is a regular div and does not affect the root scroll mechanism.
   */
  /* Background color visible behind overscroll / pull-to-refresh */
  background-color: #FFF5E1;
}

html.dark {
  background-color: #1a1a4e;
}

body {
  margin: 0;
  font-family: 'Inter', system-ui, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  /* Native-app feel: disable text selection everywhere … */
  user-select: none;
  -webkit-user-select: none;
  /* NOTE: do NOT set overflow-x: hidden on body – on iOS Safari this propagates
     to the viewport and can silently break touch-scroll on inner containers.
     Horizontal clipping is handled by .app-shell { overflow-x: clip } instead. */
  /* Disable text selection on UI elements (not content) */
  -webkit-user-select: none;
  user-select: none;
  /* Remove tap highlight on mobile WebKit */
  -webkit-tap-highlight-color: transparent;
  /* Prevent overscroll bounce (iOS Safari) */
  overscroll-behavior: none;
  /* Restrict touch panning to vertical only – blocks horizontal swipe-scroll */
  touch-action: pan-y pinch-zoom;
  /* Respect notch / dynamic island safe areas */
  padding: env(safe-area-inset-top) env(safe-area-inset-right) 0 env(safe-area-inset-left);
}

/* … but re-enable inside editable form fields so users can still
   type, copy/paste and interact normally with text inputs */
input, textarea, [contenteditable="true"],
input:focus, textarea:focus {
  -webkit-user-select: text;
  user-select: text;
}

/* Disable long-press callout on images/links in PWA */
img, a, button {
  -webkit-touch-callout: none;
}

/* Smooth momentum scrolling in all scrollable containers */
[class*="overflow-auto"],
[class*="overflow-y-auto"],
[class*="overflow-scroll"] {
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
  touch-action: pan-y;
}

/* Ensure iOS Safari passes vertical swipe gestures to the scroll container
   instead of "absorbing" them on non-scrollable divs/sections. Without this,
   touching a card and swiping up/down does nothing because the card has
   touch-action:auto and iOS heuristically cancels the scroll. */
.app-main section,
.app-main aside,
.app-main article,
.app-main .page-shell {
  touch-action: pan-y;
}

.app-shell,
.app-main {
  width: 100%;
  max-width: 100%;
}

/* Only clip horizontal overflow on the outer shell – do NOT apply to
   .app-main because on mobile it is the vertical scroll container
   (h-[100svh] overflow-y-auto).  iOS Safari breaks y-scrolling when
   overflow-x:clip is combined with overflow-y:auto on the same element. */
.app-shell {
  overflow-x: hidden;
  overflow-x: clip;
}

.app-main > * {
  min-width: 0;
}

@media (max-width: 639px) {
  .app-main > * {
    width: 100%;
    max-width: 100%;
  }
}

.app-main :where(.flex, .grid) > * {
  min-width: 0;
}

.app-main img,
.app-main video,
.app-main iframe,
.app-main canvas {
  max-width: 100%;
}

.theme-transition,
.theme-transition * {
  transition-property: background-color, color, border-color, fill, stroke;
  transition-duration: 300ms;
  transition-timing-function: ease;
}

.route-transition {
  animation: route-enter 260ms ease both;
}

@keyframes route-enter {
  from {
    opacity: 0;
    transform: translateY(8px);
  }

  to {
    opacity: 1;
    /* NOTE: intentionally no `transform` here – a persisted transform
       (even translateY(0)) creates a new containing‑block for `fixed`
       children, which breaks full‑screen overlays / modals inside routes. */
  }
}

@media (prefers-reduced-motion: reduce) {
  .theme-transition,
  .theme-transition * {
    transition-duration: 1ms;
  }

  .route-transition {
    animation: none;
  }
}
